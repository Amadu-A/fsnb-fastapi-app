<!-- path: templates/admin/user_edit.html -->
{% extends "core/base.html" %}
{% block title %}Admin — Edit User{% endblock %}

{% block content %}
  <h2 class="title">Редактирование пользователя #{{ user.id }}</h2>

  <form method="post" action="{{ request.url_for('admin_user_edit_post', user_id=user.id) }}" class="card admin-user">
    <input type="hidden" name="csrf_token" value="{{ csrf }}">

    <h3 class="admin-user__subtitle">Учётная запись</h3>

    <div class="form__row">
      <label class="form__label">Username</label>
      <div class="form__control">
        <input class="form__input" type="text" name="username" value="{{ user.username or '' }}">
      </div>
    </div>

    <div class="form__row">
      <label class="form__label">Активен</label>
      <div class="form__control">
        <label class="admin__check">
          <input type="checkbox" name="is_active" {% if user.is_active %}checked{% endif %}>
          <span>is_active</span>
        </label>
      </div>
    </div>

    <h3 class="admin-user__subtitle">Профиль</h3>

    <div class="form__row"><label class="form__label">Nickname</label><div class="form__control"><input class="form__input" type="text" name="nickname" value="{{ profile.nickname or '' }}"></div></div>
    <div class="form__row"><label class="form__label">Имя</label><div class="form__control"><input class="form__input" type="text" name="first_name" value="{{ profile.first_name or '' }}"></div></div>
    <div class="form__row"><label class="form__label">Фамилия</label><div class="form__control"><input class="form__input" type="text" name="second_name" value="{{ profile.second_name or '' }}"></div></div>
    <div class="form__row"><label class="form__label">Телефон</label><div class="form__control"><input class="form__input" type="text" name="phone" value="{{ profile.phone or '' }}"></div></div>
    <div class="form__row"><label class="form__label">E-mail (в профиле)</label><div class="form__control"><input class="form__input" type="text" name="email" value="{{ profile.email or '' }}"></div></div>
    <div class="form__row"><label class="form__label">Telegram ID</label><div class="form__control"><input class="form__input" type="text" name="tg_id" value="{{ profile.tg_id or '' }}"></div></div>
    <div class="form__row"><label class="form__label">Telegram nickname</label><div class="form__control"><input class="form__input" type="text" name="tg_nickname" value="{{ profile.tg_nickname or '' }}"></div></div>

    <div class="form__row">
      <label class="form__label">Подтверждён</label>
      <div class="form__control">
        <label class="admin__check">
          <input type="checkbox" name="verification" {% if profile.verification %}checked{% endif %}>
          <span>verification</span>
        </label>
      </div>
    </div>

    <h3 class="admin-user__subtitle">Права</h3>

    {% if perm_note %}
      <div class="alert alert--error">{{ perm_note }}</div>
    {% endif %}

    <div class="grid grid--2 admin-user__grid">
      <label class="admin__check">
        <input type="checkbox" name="is_superadmin"
               {% if perm.is_superadmin %}checked{% endif %}
               {% if not can_edit_super_flag or not perm_editable %}disabled{% endif %}>
        <span>is_superadmin</span>
      </label>

      <label class="admin__check">
        <input type="checkbox" name="is_admin_flag"
               {% if perm.is_admin %}checked{% endif %}
               {% if not perm_editable %}disabled{% endif %}>
        <span>is_admin</span>
      </label>

      <label class="admin__check">
        <input type="checkbox" name="is_staff"
               {% if perm.is_staff %}checked{% endif %}
               {% if not perm_editable %}disabled{% endif %}>
        <span>is_staff</span>
      </label>

      <label class="admin__check">
        <input type="checkbox" name="is_updater"
               {% if perm.is_updater %}checked{% endif %}
               {% if not perm_editable %}disabled{% endif %}>
        <span>is_updater</span>
      </label>

      <label class="admin__check">
        <input type="checkbox" name="is_reader"
               {% if perm.is_reader %}checked{% endif %}
               {% if not perm_editable %}disabled{% endif %}>
        <span>is_reader</span>
      </label>

      <label class="admin__check">
        <input type="checkbox" name="is_user_flag"
               {% if perm.is_user %}checked{% endif %}
               {% if not perm_editable %}disabled{% endif %}>
        <span>is_user</span>
      </label>
    </div>

    <div class="admin-user__actions">
      <button type="submit" class="btn btn--primary">Сохранить</button>
      <a class="btn" href="{{ request.url_for('admin_users') }}">Назад к списку</a>
    </div>
  </form>
{% endblock %}
