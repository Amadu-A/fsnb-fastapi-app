<!-- /templates/admin/perm_edit.html -->
{% extends "core/base.html" %}
{% block title %}Admin — Edit Permissions{% endblock %}

{% block content %}
  <h2>Permissions (profile_id={{ perm.profile_id }})</h2>

  {% if forbidden_reason %}
    <div class="alert alert-error">{{ forbidden_reason }}</div>
  {% endif %}

  <form method="post" action="{{ request.url_for('admin_perm_edit_post', profile_id=perm.profile_id) }}">
    <input type="hidden" name="csrf_token" value="{{ csrf }}">

    {% set ro = 'disabled' if read_only else '' %}
    {% set dis_super = '' if can_edit_super_flag and not read_only else 'disabled' %}

    <div class="form-row">
      <label>is_superadmin</label>
      <input name="is_superadmin" type="checkbox" {% if perm.is_superadmin %}checked{% endif %} {{ dis_super }}>
      {% if not can_edit_super_flag %}
        <small class="hint">Только суперпользователь может менять этот флаг</small>
      {% endif %}
    </div>

    <div class="form-row"><label>is_admin</label>
      <input name="is_admin" type="checkbox" {% if perm.is_admin %}checked{% endif %} {{ ro }}>
    </div>
    <div class="form-row"><label>is_staff</label>
      <input name="is_staff" type="checkbox" {% if perm.is_staff %}checked{% endif %} {{ ro }}>
    </div>
    <div class="form-row"><label>is_updater</label>
      <input name="is_updater" type="checkbox" {% if perm.is_updater %}checked{% endif %} {{ ro }}>
    </div>
    <div class="form-row"><label>is_reader</label>
      <input name="is_reader" type="checkbox" {% if perm.is_reader %}checked{% endif %} {{ ro }}>
    </div>
    <div class="form-row"><label>is_user</label>
      <input name="is_user" type="checkbox" {% if perm.is_user %}checked{% endif %} {{ ro }}>
    </div>

    {% if not read_only %}
      <button class="btn btn-primary" type="submit">Save</button>
    {% else %}
      <button class="btn btn-primary" type="submit" disabled>Save</button>
    {% endif %}
  </form>
{% endblock %}
