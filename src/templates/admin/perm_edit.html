<!-- path: templates/admin/perm_edit.html -->
{% extends "core/base.html" %}
{% block title %}Admin — Edit Permissions{% endblock %}

{% block content %}
  <h2 class="title">Permissions (profile_id={{ perm.profile_id }})</h2>

  {% if forbidden_reason %}
    <div class="alert alert--error">{{ forbidden_reason }}</div>
  {% endif %}

  <form class="form" method="post" action="{{ request.url_for('admin_perm_edit_post', profile_id=perm.profile_id) }}">
    <input type="hidden" name="csrf_token" value="{{ csrf }}">

    {% set ro = 'disabled' if read_only else '' %}
    {% set dis_super = '' if can_edit_super_flag and not read_only else 'disabled' %}

    <div class="admin__checks">
      <label class="admin__check">
        <input name="is_superadmin" type="checkbox" {% if perm.is_superadmin %}checked{% endif %} {{ dis_super }}>
        <span>is_superadmin</span>
      </label>
      {% if not can_edit_super_flag %}
        <small class="admin__hint">Только суперпользователь может менять этот флаг</small>
      {% endif %}

      <label class="admin__check"><input name="is_admin" type="checkbox" {% if perm.is_admin %}checked{% endif %} {{ ro }}><span>is_admin</span></label>
      <label class="admin__check"><input name="is_staff" type="checkbox" {% if perm.is_staff %}checked{% endif %} {{ ro }}><span>is_staff</span></label>
      <label class="admin__check"><input name="is_updater" type="checkbox" {% if perm.is_updater %}checked{% endif %} {{ ro }}><span>is_updater</span></label>
      <label class="admin__check"><input name="is_reader" type="checkbox" {% if perm.is_reader %}checked{% endif %} {{ ro }}><span>is_reader</span></label>
      <label class="admin__check"><input name="is_user" type="checkbox" {% if perm.is_user %}checked{% endif %} {{ ro }}><span>is_user</span></label>
    </div>

    <div class="form__actions">
      {% if not read_only %}
        <button class="btn btn--primary" type="submit">Save</button>
      {% else %}
        <button class="btn btn--primary" type="submit" disabled>Save</button>
      {% endif %}
    </div>
  </form>
{% endblock %}
